{"version":3,"file":"ngx-highlightjs.umd.min.js","sources":["../../src/directives/highlight.directive.ts","../../src/modules/highlight.module.ts"],"sourcesContent":["import { Directive, AfterViewInit, ElementRef, Renderer2, OnDestroy, Input } from '@angular/core';\n\n/** Rollup: does not allow this \"import * as\" otherwise highlight.js script would have merged with the module */\n// import * as hljs from 'highlight.js';\n\ndeclare const hljs: any;\n\nimport { Subject } from 'rxjs/Subject';\nimport { Observable } from 'rxjs/Observable';\nimport'rxjs/add/observable/from';\nimport'rxjs/add/operator/map';\nimport'rxjs/add/operator/switchMap';\nimport'rxjs/add/operator/take';\nimport'rxjs/add/operator/delay';\nexport class HighlightDirective implements AfterViewInit, OnDestroy {\n\n  el: HTMLElement;\n  domObs: MutationObserver;\n  highlighter$ = new Subject<any>();\n\n   highlight;\n   hlAuto = true;\n   hlDelay = 200;\n/**\n * @param {?} el\n * @param {?} renderer\n */\nconstructor(el: ElementRef,\nprivate renderer: Renderer2) {\n    this.el = el.nativeElement;\n  }\n/**\n * @return {?}\n */\nngAfterViewInit() {\n\n    if (typeof hljs === 'undefined') {\n      throw new Error('Highlight.js is not loaded.');\n    }\n\n    let /** @type {?} */ codeElements: any = [];\n\n    this.highlighter$.delay(this.hlDelay)\n      .switchMap(() => {\n\n        switch (this.highlight) {\n          case 'all':\n            codeElements = this.el.querySelectorAll('pre code');\n            break;\n          case '':\n            codeElements = [this.el];\n            break;\n          default:\n            codeElements = this.el.querySelectorAll(this.highlight);\n        }\n\n        return Observable.from(codeElements)\n          .take(1)\n          .map((code: HTMLElement) => {\n\n            /** Highlight only If content is plain text */\n            if (code.childNodes.length === 1 && code.childNodes[0].nodeName === '#text') {\n\n              const /** @type {?} */ highlightedCode = hljs.highlightAuto(code.innerText.trim()).value;\n\n              /** Render the highlighted code */\n              if (highlightedCode) {\n                this.renderer.setProperty(code, 'innerHTML', highlightedCode);\n              }\n\n            }\n          });\n      }).subscribe();\n\n    this.highlighter$.next();\n\n    /** Auto highlight on changes */\n    if (this.hlAuto) {\n      this.domObs = new MutationObserver(() => this.highlighter$.next());\n      this.domObs.observe(this.el, { childList: true, subtree: true });\n    }\n  }\n/**\n * @return {?}\n */\nngOnDestroy() {\n    if (this.hlAuto) {\n      this.domObs.disconnect();\n    }\n    this.highlighter$.unsubscribe();\n  }\n\nstatic decorators: DecoratorInvocation[] = [\n{ type: Directive, args: [{\n  selector: '[highlight]'\n}, ] },\n];\n/**\n * @nocollapse\n */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: ElementRef, },\n{type: Renderer2, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'highlight': [{ type: Input, args: ['highlight', ] },],\n'hlAuto': [{ type: Input },],\n'hlDelay': [{ type: Input },],\n};\n}\n\nfunction HighlightDirective_tsickle_Closure_declarations() {\n/** @type {?} */\nHighlightDirective.decorators;\n/**\n * @nocollapse\n * @type {?}\n */\nHighlightDirective.ctorParameters;\n/** @type {?} */\nHighlightDirective.propDecorators;\n/** @type {?} */\nHighlightDirective.prototype.el;\n/** @type {?} */\nHighlightDirective.prototype.domObs;\n/** @type {?} */\nHighlightDirective.prototype.highlighter$;\n/** @type {?} */\nHighlightDirective.prototype.highlight;\n/** @type {?} */\nHighlightDirective.prototype.hlAuto;\n/** @type {?} */\nHighlightDirective.prototype.hlDelay;\n/** @type {?} */\nHighlightDirective.prototype.renderer;\n}\n\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n","import { NgModule } from '@angular/core';\nimport { HighlightDirective } from './../directives/highlight.directive';\nexport class HighlightModule { static decorators: DecoratorInvocation[] = [\n{ type: NgModule, args: [{\n    declarations: [HighlightDirective],\n    exports: [HighlightDirective]\n}, ] },\n];\n/**\n * @nocollapse\n */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n];\n}\n\nfunction HighlightModule_tsickle_Closure_declarations() {\n/** @type {?} */\nHighlightModule.decorators;\n/**\n * @nocollapse\n * @type {?}\n */\nHighlightModule.ctorParameters;\n}\n\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"],"names":["HighlightDirective","el","renderer","this","highlighter$","Subject","hlAuto","hlDelay","nativeElement","prototype","ngAfterViewInit","_this","hljs","Error","codeElements","delay","switchMap","highlight","querySelectorAll","Observable","from","take","map","code","childNodes","length","nodeName","highlightedCode","highlightAuto","innerText","trim","value","setProperty","subscribe","next","domObs","MutationObserver","observe","childList","subtree","ngOnDestroy","disconnect","unsubscribe","decorators","type","Directive","args","selector","ctorParameters","ElementRef","Renderer2","propDecorators","Input","HighlightModule","NgModule","declarations","exports"],"mappings":"+xBAcA,IAAAA,oBAAA,WAaA,QAAAA,oBADGC,GAAmCC,UAAAC,KAAtCD,SAAsCA,SARpCC,KAAFC,aAEiB,GAAIC,cAFrBA,QAGGF,KAAHG,QAEY,EADTH,KAAHI,QAEa,IAKTJ,KAAKF,GAAKA,GAAGO,oBAKjBR,oBAAAS,UAAAC,gBAAA,WAAA,GAAAC,OAAAR,IAEI,IAJoB,mBAATS,MAKT,KAJM,IAAIC,OAAM,8BAOlB,IAJIC,gBAMJX,MAJKC,aAAaW,MAAMZ,KAAKI,SAK1BS,UAJU,WAMT,OAAQL,MAJKM,WAKX,IAJK,MAKHH,aAJeH,MAAKV,GAAGiB,iBAAiB,WAKxC,MACF,KAJK,GAKHJ,cAJeH,MAAMV,GAKrB,MACF,SACEa,aAJeH,MAAKV,GAAGiB,iBAAiBP,MAAKM,WAOjD,MAJOE,iBAIfA,WAJ0BC,KAAKN,cAKpBO,KAJK,GAKLC,IAJI,SAACC,MAOJ,GAJ+B,IAI3BA,KAJKC,WAAWC,QAAgD,UAAhCF,KAAKC,WAAW,GAAGE,SAAsB,CAM3E,GAJMC,iBAAkBf,KAAKgB,cAAcL,KAAKM,UAAUC,QAAQC,KAO9DJ,kBACFhB,MAJKT,SAAS8B,YAAYT,KAAM,YAAaI,sBAKpDM,YAML9B,KAJKC,aAAa8B,OAOd/B,KAJKG,SAKPH,KAJKgC,OAAS,GAAIC,kBAAiB,WAAM,MAAAzB,OAAKP,aAAa8B,SAK3D/B,KAJKgC,OAAOE,QAAQlC,KAAKF,IAAMqC,WAAW,EAAMC,SAAS,MAU/DvC,mBAAAS,UAAA+B,YAAA,WACQrC,KANKG,QAOPH,KANKgC,OAAOM,aAQdtC,KANKC,aAAasC,oCAGf1C,oBAAP2C,aACEC,KAAMC,cAMRA,UANmBC,OAOjBC,SANU,kBAIX/C,mBAADgD,eAAC,WAAA,QASAJ,KAbCK,cAaFA,aACCL,KAAMM,cAAPA,aANOlD,mBAAPmD,gBASAlC,YARgB2B,KAAMQ,cAQtBA,MAR6BN,MAAM,eASnCxC,SARasC,KAAMQ,cAQnBA,QACA7C,UARcqC,KAAMQ,cAQpBA,QCzGA,IAAAC,iBAAA,WAAA,QAAAA,6CAEsCA,iBAAtCV,aACEC,KAAMU,cAFRA,SAEkBR,OADdS,cAEcvD,oBADdwD,SAESxD,wBAIZqD,gBAADL,eAAC,WAAA"}