{"version":3,"file":"ngx-highlightjs.js","sources":["../../index.ts","../../src/modules/highlight.module.ts","../../src/directives/highlight.directive.ts"],"sourcesContent":["/**\n * Generated bundle index. Do not edit.\n */\n\nexport {HighlightModule} from './public_api';\n\nexport {HighlightDirective as Éµa} from './src/directives/highlight.directive';","import { NgModule } from '@angular/core';\nimport { HighlightDirective } from './../directives/highlight.directive';\nexport class HighlightModule { static decorators: DecoratorInvocation[] = [\n{ type: NgModule, args: [{\n    declarations: [HighlightDirective],\n    exports: [HighlightDirective]\n}, ] },\n];\n/**\n * @nocollapse\n */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n];\n}\n\nfunction HighlightModule_tsickle_Closure_declarations() {\n/** @type {?} */\nHighlightModule.decorators;\n/**\n * @nocollapse\n * @type {?}\n */\nHighlightModule.ctorParameters;\n}\n\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n","import { Directive, AfterViewInit, ElementRef, Renderer2, OnDestroy, Input } from '@angular/core';\n\n/** Rollup: does not allow this \"import * as\" otherwise highlight.js script would have merged with the module */\n// import * as hljs from 'highlight.js';\n\ndeclare const hljs: any;\n\nimport { Subject } from 'rxjs/Subject';\nimport { Observable } from 'rxjs/Observable';\nimport'rxjs/add/observable/from';\nimport'rxjs/add/operator/map';\nimport'rxjs/add/operator/switchMap';\nimport'rxjs/add/operator/take';\nimport'rxjs/add/operator/delay';\nexport class HighlightDirective implements AfterViewInit, OnDestroy {\n\n  el: HTMLElement;\n  domObs: MutationObserver;\n  highlighter$ = new Subject<any>();\n\n   highlight;\n   hlAuto = true;\n   hlDelay = 200;\n/**\n * @param {?} el\n * @param {?} renderer\n */\nconstructor(el: ElementRef,\nprivate renderer: Renderer2) {\n    this.el = el.nativeElement;\n  }\n/**\n * @return {?}\n */\nngAfterViewInit() {\n\n    if (typeof hljs === 'undefined') {\n      throw new Error('Highlight.js is not loaded.');\n    }\n\n    let /** @type {?} */ codeElements: any = [];\n\n    this.highlighter$.delay(this.hlDelay)\n      .switchMap(() => {\n\n        switch (this.highlight) {\n          case 'all':\n            codeElements = this.el.querySelectorAll('pre code');\n            break;\n          case '':\n            codeElements = [this.el];\n            break;\n          default:\n            codeElements = this.el.querySelectorAll(this.highlight);\n        }\n\n        return Observable.from(codeElements)\n          .take(1)\n          .map((code: HTMLElement) => {\n\n            /** Highlight only If content is plain text */\n            if (code.childNodes.length === 1 && code.childNodes[0].nodeName === '#text') {\n\n              const /** @type {?} */ highlightedCode = hljs.highlightAuto(code.innerText.trim()).value;\n\n              /** Render the highlighted code */\n              if (highlightedCode) {\n                this.renderer.setProperty(code, 'innerHTML', highlightedCode);\n              }\n\n            }\n          });\n      }).subscribe();\n\n    this.highlighter$.next();\n\n    /** Auto highlight on changes */\n    if (this.hlAuto) {\n      this.domObs = new MutationObserver(() => this.highlighter$.next());\n      this.domObs.observe(this.el, { childList: true, subtree: true });\n    }\n  }\n/**\n * @return {?}\n */\nngOnDestroy() {\n    if (this.hlAuto) {\n      this.domObs.disconnect();\n    }\n    this.highlighter$.unsubscribe();\n  }\n\nstatic decorators: DecoratorInvocation[] = [\n{ type: Directive, args: [{\n  selector: '[highlight]'\n}, ] },\n];\n/**\n * @nocollapse\n */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: ElementRef, },\n{type: Renderer2, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'highlight': [{ type: Input, args: ['highlight', ] },],\n'hlAuto': [{ type: Input },],\n'hlDelay': [{ type: Input },],\n};\n}\n\nfunction HighlightDirective_tsickle_Closure_declarations() {\n/** @type {?} */\nHighlightDirective.decorators;\n/**\n * @nocollapse\n * @type {?}\n */\nHighlightDirective.ctorParameters;\n/** @type {?} */\nHighlightDirective.propDecorators;\n/** @type {?} */\nHighlightDirective.prototype.el;\n/** @type {?} */\nHighlightDirective.prototype.domObs;\n/** @type {?} */\nHighlightDirective.prototype.highlighter$;\n/** @type {?} */\nHighlightDirective.prototype.highlight;\n/** @type {?} */\nHighlightDirective.prototype.hlAuto;\n/** @type {?} */\nHighlightDirective.prototype.hlDelay;\n/** @type {?} */\nHighlightDirective.prototype.renderer;\n}\n\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"],"names":[],"mappings":"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"}